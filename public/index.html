<!DOCTYPE html>
<html>
<head>
	<title>Do</title>
</head>
<body>
	<h1>Do</h1>
	<form method="post" id="things">
		<ul>
			<li>
				<button type="button" value="1" name="id">
					First thing
				</button>
			</li>
			<li>
				<button type="button" value="2" name="id">
					Second item
				</button>
			</li>
			<li>
				<button type="button" value="3" name="id">
					Third whatever
				</button>
			</li>
			<li>
				<button type="button" value="4" name="id">
					Fourth thing
				</button>
			</li>
			<li>
				<button type="button" value="5" name="id">
					Other stuff
				</button>
			</li>
		</ul>
	</form>


	<script src="http://cdn.pubnub.com/pubnub.min.js" ></script>
	<script src="reqwest.js" ></script>
	<script>(function(){

		var pubnub = PUBNUB.init({
			publish_key   : 'demo',
			subscribe_key : 'demo'
		})

		pubnub.subscribe({
			channel : "do_channel",
			message : function(m){

				var buttons = document.querySelectorAll('button');
				[].forEach.call(buttons, function(b){
					if(b.value == m.did){
						b.style.background = 'hotpink';
						setTimeout(function(){
							b.style.background = '';
						},1000)
					}
				})

				console.log(m)
			},
		})

		// submit with ajax instead
		things.addEventListener('click', function(e){
			e.preventDefault();

			reqwest({
				url: '/'
				, method: 'post'
				, data: { id: e.target.value }
				, success: function (resp) {
					
				}
			})


		}, true)

	 })();</script>
</body>
</html>
